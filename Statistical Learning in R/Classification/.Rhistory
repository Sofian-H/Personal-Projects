pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
barplot(pca.var.per,main="Scree Plot",xlab="PC",ylab="Variantion %")
pca.var<-pca$sdev[1:5]^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
barplot(pca.var.per,main="Scree Plot",xlab="PC",ylab="Variantion %")
pca.var.per
pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
sum(pca.var.per[1:5])
sum(pca.var.per[1:10])
sum(pca.var.per[1:15])
sum(pca.30])
sum(pca.var.per[1:30])
sum(pca.var.per[1:50])
length(pca.var)
sum(pca.var.per[1:60])
sum(pca.var.per[1:70])
sum(pca.var.per[1:700])
sum(pca.var.per[1:784])
pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
pca.var.per
sum(pca.var.per[1:30])
sum(pca.var.per[1:100])
pca<-prcomp(train[,1:784],retx=TRUE,tol=0.01)
pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
barplot(pca.var.per,main="Scree Plot",xlab="PC",ylab="Variantion %")
pca.var.per
sum(pca.var.per[1:37])
sum(pca.var.per[1:370])
sum(pca.var.per[1:784])
pca$x
pca$x[1]
pca$x[1,]
pca$x[,1]
pca$rotation
pca$rotation[1,]
pca$rotation[,1]
dim(pca$rotation)
dim(pca$x)
pca
summary(pca)
pca$x
dim(pca$x)
summary(pca$x)
pca$rotation[1,
]
pca$rotation[,1]
dim(pca$rotation[,1]=
dim(pca$rotation[,1])
pca$rotation[,1]-train[,1:784]%*%pca$rotation
pca$rotation
pca$rotation[1,]
pca$rotation[,1]
pca$x
pca$x[1,]
pca$x[,1]
pca$rotation
pca$x[1:37,]
pca$x[,1:37]
dim(pca$x)
proj_train<-pca$x[,1:37]
proj_train<-cbind(proj_train,train$y)
proj_train
pca$rotation
dim(pca$rotation)
summary(proj_train)
class(proj_train)
proj_train<-as.dataframe(cbind(proj_train,train$y))
proj_train<-as.data.frame(cbind(proj_train,train$y))
summary(proj_train)
proj_trian
proj_train
dim(proj_train)
View(pca)
proj_train<-pca$x[,1:37]
proj_train<-as.data.frame(cbind(proj_train,train$y))
proj_train
dim(proj_train)
dim(pca$rotation)
#projecting the training set on the PCs
proj_test<-test%*%pca$rotation[,1:37]
class(pca$rotation)
class(test)
#projecting the training set on the PCs
proj_test<-as.matrix(test)%*%pca$rotation[,1:37]
proj_test<-as.data.frame(cbind(proj_test),test$y)
library(MASS)
pca
model<-lda(y~.,proj_train)
proj_train
class(proj_train)
head(proj_train)
View(proj_train)
View(proj_train)
proj_train[38]
proj_train[38]<-"y"
#The column was named V38 so simply renaming it y
proj_train[38]<-"y"
proj_train$y
proj_train$""
proj_train$"y"
#The column was named V38 so simply renaming it y
proj_train[38]<-"y"
proj_train$y
proj_train$38
proj_train$V38
proj_train<-pca$x[,1:37]
proj_train<-as.data.frame(cbind(proj_train,train$y))
proj_train$V38
max(proj_train$V38)
max(train$y)
train$y
proj_train$V38[1]
proj_train$V38[2]
proj_train<-pca$x[,1:37]
proj_train<-cbind(proj_train,train$y)
proj_train<-as.data.frame(proj_train)
proj_train$V38
proj_train$V38 - train$y
as.matrix(proj_train$V38)-as.matrix(train$y)
as.matrix(proj_train$V38)%-%as.matrix(train$y)
for (i in dim(proj_train)[1]) {
res=proj_train$V38[i]-train$y[i]
print(res)
}
[i]
proj_train$V38[i]
proj_train$V38
proj_train$V38[i]
proj_train$V38[1]
class(proj_train$V38[1])
c(1,1,1)-1
proj_train$V38[115]
train$y[115]
#For some reason all values in V38 were incremented by 1 compared to train$y
#I'm therefore just correcting that here
proj_train$V38<-proj_train$V38-1
proj_train$V38
#projecting the training set on the PCs
proj_test<-as.matrix(test)%*%pca$rotation[,1:37]
proj_test<-as.data.frame(cbind(proj_test),test$y)
proj_test<-as.data.frame(cbind(proj_test),test$y)
proj_test<-as.data.frame(cbind(proj_test),test$y)
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test<-as.data.frame(cbind(proj_test),test$y)
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test
proj_test<-as.data.frame(cbind(proj_test),test$y)
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test<-as.data.frame(cbind(proj_test,test$y))
proj_test<-NULL
proj_test
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test
dim(proj_test)
# The following code was copied and pasted from the below link :
# https://gist.github.com/daviddalpiaz/ae62ae5ccd0bada4b9acd6dbc9008706
# It is designed to help read the mnist files
# helper function for visualization
show_digit = function(arr784, col = gray(12:1 / 12), ...) {
image(matrix(as.matrix(arr784[-785]), nrow = 28)[, 28:1], col = col, ...)
}
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
train = load_image_file("..\\Task 3\\train-images.idx3-ubyte")
test  = load_image_file("..\\Task 3\\t10k-images.idx3-ubyte")
# load labels
train$y = as.factor(load_label_file("..\\Task 3\\train-labels.idx1-ubyte"))
# The following code was copied and pasted from the below link :
# https://gist.github.com/daviddalpiaz/ae62ae5ccd0bada4b9acd6dbc9008706
# It is designed to help read the mnist files
# helper function for visualization
show_digit = function(arr784, col = gray(12:1 / 12), ...) {
image(matrix(as.matrix(arr784[-785]), nrow = 28)[, 28:1], col = col, ...)
}
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
train = load_image_file("..\\Task 3\\train-images.idx3-ubyte")
test  = load_image_file("..\\Task 3\\t10k-images.idx3-ubyte")
# load labels
train$y = as.factor(load_label_file("..\\Task 3\\train-labels.idx1-ubyte"))
# The following code was copied and pasted from the below link :
# https://gist.github.com/daviddalpiaz/ae62ae5ccd0bada4b9acd6dbc9008706
# It is designed to help read the mnist files
# helper function for visualization
show_digit = function(arr784, col = gray(12:1 / 12), ...) {
image(matrix(as.matrix(arr784[-785]), nrow = 28)[, 28:1], col = col, ...)
}
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
train = load_image_file("..\\Task 3\\train-images.idx3-ubyte")
test  = load_image_file("..\\Task 3\\t10k-images.idx3-ubyte")
# load labels
train$y = as.factor(load_label_file("..\\Task 3\\train-labels.idx1-ubyte"))
test$y  = as.factor(load_label_file("t10k-labels-idx1-ubyte"))
# The following code was copied and pasted from the below link :
# https://gist.github.com/daviddalpiaz/ae62ae5ccd0bada4b9acd6dbc9008706
# It is designed to help read the mnist files
# helper function for visualization
show_digit = function(arr784, col = gray(12:1 / 12), ...) {
image(matrix(as.matrix(arr784[-785]), nrow = 28)[, 28:1], col = col, ...)
}
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
train = load_image_file("..\\Task 3\\train-images.idx3-ubyte")
test  = load_image_file("..\\Task 3\\t10k-images.idx3-ubyte")
# load labels
train$y = as.factor(load_label_file("..\\Task 3\\train-labels.idx1-ubyte"))
test$y  = as.factor(load_label_file("..\\Task 3\\t10k-labels-idx1-ubyte"))
# The following code was copied and pasted from the below link :
# https://gist.github.com/daviddalpiaz/ae62ae5ccd0bada4b9acd6dbc9008706
# It is designed to help read the mnist files
# helper function for visualization
show_digit = function(arr784, col = gray(12:1 / 12), ...) {
image(matrix(as.matrix(arr784[-785]), nrow = 28)[, 28:1], col = col, ...)
}
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
train = load_image_file("..\\Task 3\\train-images.idx3-ubyte")
test  = load_image_file("..\\Task 3\\t10k-images.idx3-ubyte")
# load labels
train$y = as.factor(load_label_file("..\\Task 3\\train-labels.idx1-ubyte"))
test$y  = as.factor(load_label_file("..\\Task 3\\t10k-labels-idx1-ubyte"))
test$y  = as.factor(load_label_file("..\\Task 3\\t10k-labels-idx1-ubyte"))
test$y  = as.factor(load_label_file("..\\Task 3\\t10k-labels.idx1-ubyte"))
#Part of the code below was copied from the following video :
# https://www.youtube.com/watch?v=0Jp4gsfOLMs
pca<-prcomp(train[,1:784],retx=TRUE,tol=0.01)
pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
#We project our dataset onto the 37 first PCs
proj_train<-pca$x[,1:37]
proj_train<-cbind(proj_train,train$y)
#note that the newly added column has name V38 rather than y
proj_train<-as.data.frame(proj_train)
#For some reason all values in V38 were incremented by 1 compared to train$y
#I'm therefore just correcting that here
proj_train$V38<-proj_train$V38-1
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test<-cbind(proj_test,test$)
library(MASS)
model<-lda(y~.,proj_train)
model<-lda(V38~.,proj_train)
proj_test<-cbind(proj_test,test$y)
proj_test<-as.data.frame(proj_test)
proj_test
#Same thing here, all values were somehow incremented by 1
proj_test$V38<-proj_test$V38-1
proj_test
max(proj_test[,38]
)
prec<-prediction(model,proj_test)
predictions<-predict(model,proj_test)
predictions
predictions$class
predictions$x
predictions$posterior
predictions$class[1]
count(proj_test$V8==1)
summary(proj_test)
for (i in 1:dim(proj_test)[1]){
counts[proj_test[i]+1]<-counts[proj_test[i]+1]+1
}
#On to error rates
overall_err<-0
#The counts variable will store the number of occurrences of each class
counts<-c(0:9)*0
cls_err<-c(0:9)*0
for (i in 1:dim(proj_test)[1]){
counts[proj_test[i]+1]<-counts[proj_test[i]+1]+1
}
for (i in 1:dim(proj_test)[1]){
counts[proj_test[i,38]+1]<-counts[proj_test[i]+1]+1
}
for (i in 1:dim(proj_test)[1]){
counts[proj_test$V38[i]+1]<-counts[proj_test$V38[i]+1]+1
}
counts
sum(counts)
#On to error rates
overall_err<-0
#The counts variable will store the number of occurrences of each class
counts<-c(0:9)*0
cls_err<-c(0:9)*0
#counting the nb of occurrences of each class
for (i in 1:dim(proj_test)[1]){
counts[proj_test$V38[i]+1]<-counts[proj_test$V38[i]+1]+1
}
#Calculating the errors
for (i in 1:dim(proj_test)[1]) {
if (proj_test$V38[i]!=predictions[i]) {
cls_err[proj_test$V38[i]+1]<-cls_err[proj_test$V38[i]+1]+1
overall_err<-overall_err+1
}
}
for (i in 1:10) {
cls_err[i]<-cls_err[i]/count[i]
}
overall_err<-overall_err/10000
#On to error rates
overall_err<-0
#The counts variable will store the number of occurrences of each class
counts<-c(0:9)*0
cls_err<-c(0:9)*0
#counting the nb of occurrences of each class
for (i in 1:dim(proj_test)[1]){
counts[proj_test$V38[i]+1]<-counts[proj_test$V38[i]+1]+1
}
#Calculating the errors
for (i in 1:dim(proj_test)[1]) {
if (proj_test$V38[i]!=predictions[i]) {
cls_err[proj_test$V38[i]+1]<-cls_err[proj_test$V38[i]+1]+1
overall_err<-overall_err+1
}
}
for (i in 1:10) {
cls_err[i]<-cls_err[i]/counts[i]
}
overall_err<-overall_err/10000
overall_err
#counting the nb of occurrences of each class
for (i in 1:dim(proj_test)[1]){
counts[proj_test$V38[i]+1]<-counts[proj_test$V38[i]+1]+1
}
#Calculating the errors
for (i in 1:dim(proj_test)[1]) {
if (proj_test$V38[i]!=predictions$class[i]) {
cls_err[proj_test$V38[i]+1]<-cls_err[proj_test$V38[i]+1]+1
overall_err<-overall_err+1
}
}
for (i in 1:10) {
cls_err[i]<-cls_err[i]/counts[i]
}
overall_err<-overall_err/10000
overall_err
cls_err
sum(cls_err)
for (i in 1:10) {
print(paste("95% CI for class",i-1,"error rate : [",cls_err[i]-1/sqrt(counts(i)),",",cls_err[i]+1/sqrt(counts(i))))
}
for (i in 1:10) {
print(paste("95% CI for class",i-1,"error rate : [",cls_err[i]-1/sqrt(counts[i]),",",cls_err[i]+1/sqrt(counts[i])))
}
for (i in 1:10) {
print(paste("95% CI for class",i-1,"error rate : [",cls_err[i]-1/sqrt(counts[i]),",",cls_err[i]+1/sqrt(counts[i],"]")))
}
for (i in 1:10) {
print(paste("95% CI for class",i-1,"error rate : [",cls_err[i]-1/sqrt(counts[i]),",",cls_err[i]+1/sqrt(counts[i]),"]"))
}
print(paste("95% CI for the overall error rate : [",overall_err-1/sqrt(10000),",",overall_err+1/sqrt(10000),"]"))
library(RWeka)
??FLDA
#Part of the code below was copied from the following video :
# https://www.youtube.com/watch?v=0Jp4gsfOLMs
pca<-prcomp(train[,1:784],retx=TRUE,tol=0.01)
pca.var<-pca$sdev^2
pca.var.per<-round(pca.var/sum(pca.var)*100)
#We project our dataset onto the 37 first PCs
proj_train<-pca$x[,1:37]
proj_train<-cbind(proj_train,train$y)
#note that the newly added column has name V38 rather than y
proj_train<-as.data.frame(proj_train)
#For some reason all values in V38 were incremented by 1 compared to train$y
#I'm therefore just correcting that here
proj_train$V38<-proj_train$V38-1
#projecting the training set on the PCs
proj_test<-as.matrix(test[,1:784])%*%pca$rotation[,1:37]
proj_test<-cbind(proj_test,test$y)
proj_test<-as.data.frame(proj_test)
#Same thing here, all values were somehow incremented by 1
proj_test$V38<-proj_test$V38-1
library(MASS)
model<-qda(V38~.,proj_train)
predictions<-predict(model,proj_test)
#On to error rates
overall_err<-0
#The counts variable will store the number of occurrences of each class
counts<-c(0:9)*0
cls_err<-c(0:9)*0
#counting the nb of occurrences of each class
for (i in 1:dim(proj_test)[1]){
counts[proj_test$V38[i]+1]<-counts[proj_test$V38[i]+1]+1
}
#Calculating the errors
for (i in 1:dim(proj_test)[1]) {
if (proj_test$V38[i]!=predictions$class[i]) {
cls_err[proj_test$V38[i]+1]<-cls_err[proj_test$V38[i]+1]+1
overall_err<-overall_err+1
}
}
for (i in 1:10) {
cls_err[i]<-cls_err[i]/counts[i]
}
overall_err<-overall_err/10000
#printing the error rates
for (i in 1:10) {
print(paste("95% CI for class",i-1,"error rate : [",cls_err[i]-1/sqrt(counts[i]),",",cls_err[i]+1/sqrt(counts[i]),"]"))
}
print(paste("95% CI for the overall error rate : [",overall_err-1/sqrt(10000),",",overall_err+1/sqrt(10000),"]"))
overall_err
cls_err
library(class)
??knn
